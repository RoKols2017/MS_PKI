# Project Audit Report: PKI Infrastructure Audit & Alignment Tool

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞**: 2026-01-22  
**–ê—É–¥–∏—Ç–æ—Ä**: Senior PKI Engineer + Security Architect + DevOps Lead  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞**: 1.0.0  
**–£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏**: Banking-Grade / National PKI Infrastructure

---

## Executive Summary

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏—Ç–∞ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è PKI-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ –±–∞–∑–µ Microsoft AD CS. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞, –Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ production.

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞**: ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –î–û–†–ê–ë–û–¢–ö–ê** –ø–µ—Ä–µ–¥ production deployment

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**: 8  
**–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: 12  
**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: 15  
**–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: 8

---

## 1. Architecture Review

### ‚úÖ –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑**: Audit ‚Üí Validation ‚Üí Alignment
2. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã
3. **Read-only –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. **WhatIf/Apply –º–æ–¥–µ–ª—å**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
5. **Legacy-safe –ø–æ–¥—Ö–æ–¥**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ legacy –ø—É—Ç–µ–π

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

#### CRITICAL-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rollback —Ñ—É–Ω–∫—Ü–∏–π
**–†–∏—Å–∫**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö  
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ**: –ü–æ—Ç–µ—Ä—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ rollback –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### CRITICAL-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ä–µ–µ—Å—Ç—Ä–∞ CA
**–†–∏—Å–∫**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ CA –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è CA  
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–ª–æ–º–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é CA  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è CA –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é

#### CRITICAL-3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç path traversal
**–†–∏—Å–∫**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–æ–≤ –≤–Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π  
**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ**: –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Å–µ—Ö –ø—É—Ç–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Resolve-Path –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –±–∞–∑–æ–≤—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

---

## 2. Security Review

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### CRITICAL-4: –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:377`  
**–ü—Ä–æ–±–ª–µ–º–∞**: `Copy-Item` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—É—Ç–∏  
**–†–∏—Å–∫**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ-CRL —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ —Ñ–∞–π–ª–æ–≤ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: 
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç–∏ –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å CRL –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º

#### CRITICAL-5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è CA –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:302`  
**–ü—Ä–æ–±–ª–µ–º–∞**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ CA —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç  
**–†–∏—Å–∫**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–ª–∏ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ CA  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è CA —á–µ—Ä–µ–∑ `certutil -getconfig -ping`

#### CRITICAL-6: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π —Ä–µ–µ—Å—Ç—Ä–∞
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:316`  
**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–ø–∏—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ URL  
**–†–∏—Å–∫**: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ URL –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é CRL  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç URL –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é

### ‚ö†Ô∏è –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### HIGH-1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä –∏ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π –∑–∞–ø–∏—Å–∏

#### HIGH-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è  
**–†–∏—Å–∫**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –∑–∞–ø—É—Å–∫–µ  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å file-based locking

---

## 3. PKI Logic Review

### ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞

1. **CRL-first –ø–æ–¥—Ö–æ–¥**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ CRL
2. **Legacy compatibility**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø—É—Ç–µ–π
3. **Canonical namespace**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—É—Ç–µ–π

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã PKI –ª–æ–≥–∏–∫–∏

#### CRITICAL-7: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ CRL –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:377`  
**–ü—Ä–æ–±–ª–µ–º–∞**: CRL –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏  
**–†–∏—Å–∫**: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö CRL –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Ç–∑—ã–≤–∞  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É CRL —á–µ—Ä–µ–∑ `certutil -dump` –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º

#### HIGH-3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ overlap period –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ CRL settings
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ overlap period –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω  
**–†–∏—Å–∫**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è gap –≤ CRL coverage  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é overlap period

#### HIGH-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ endpoints –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º URLs
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–æ–≤—ã–µ URL –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Ö –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏  
**–†–∏—Å–∫**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö URL –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º

---

## 4. Code Quality Review

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–æ–¥–∞

#### CRITICAL-8: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ switch –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:14`  
**–ü—Ä–æ–±–ª–µ–º–∞**: `[switch]$Apply = $false` - switch –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –£–±—Ä–∞—Ç—å `= $false`, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ `if (-not $Apply)`

#### HIGH-5: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö
**–§–∞–π–ª**: `src/lib/CertUtil.psm1:15`  
**–ü—Ä–æ–±–ª–µ–º–∞**: `Get-CACertificate` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `-IgnoreErrors`, –Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ certutil –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

#### HIGH-6: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–æ–≤
**–§–∞–π–ª**: `src/pki-align/Invoke-PkiAlignment.ps1:302`  
**–ü—Ä–æ–±–ª–µ–º–∞**: `$caConfig.PSChildName` –º–æ–∂–µ—Ç –±—ã—Ç—å null  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null

### ‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### MEDIUM-1: –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö CRL —Ñ–∞–π–ª–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å–µ CRL —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç—å  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å streaming –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

#### MEDIUM-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ progress reporting
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å Write-Progress

---

## 5. Documentation Review

### ‚úÖ –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **README.md**: –•–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω
2. **PKI_RULES.md**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **Runbooks**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

#### MEDIUM-3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ rollback
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ –æ—Ç–∫–∞—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏–π  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å rollback runbook

#### MEDIUM-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ troubleshooting guide
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º  
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å troubleshooting —Ä–∞–∑–¥–µ–ª

---

## 6. Risk Matrix

| ID | –ü—Ä–æ–±–ª–µ–º–∞ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –†–∏—Å–∫ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|-------------|---------|------|-----------|
| CRITICAL-1 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rollback | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-2 | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞ CA | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-3 | Path traversal | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-4 | –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-5 | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ CA | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-6 | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ URL | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-7 | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ CRL | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | üî¥ –í—ã—Å–æ–∫–∏–π | P0 |
| CRITICAL-8 | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π switch | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | üü† –°—Ä–µ–¥–Ω–∏–π | P1 |
| HIGH-1 | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | üü† –°—Ä–µ–¥–Ω–∏–π | P1 |
| HIGH-2 | –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | üü° –ù–∏–∑–∫–∏–π | P2 |

---

## 7. Fix Plan

### Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (P0)

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å switch –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—É—Ç–µ–π (path traversal protection)
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è CA
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é URL –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ —Ä–µ–µ—Å—Ç—Ä
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ CRL
6. ‚úÖ –£–ª—É—á—à–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
7. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rollback —Ñ—É–Ω–∫—Ü–∏–∏
8. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### Phase 2: –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P1)

1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
2. –î–æ–±–∞–≤–∏—Ç—å file-based locking
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É overlap period
4. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ endpoints

### Phase 3: –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (P2)

1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å progress reporting
3. –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## 8. Compliance Checklist

- [x] Read-only –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [x] WhatIf/Apply –º–æ–¥–µ–ª—å
- [x] Backup –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- [ ] Rollback —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚ö†Ô∏è
- [x] Legacy —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- [x] –ù–µ—Ç destructive –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Path traversal protection ‚ö†Ô∏è
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚ö†Ô∏è
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ ‚ö†Ô∏è

---

## 9. Recommendations

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–¥–æ production)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ CRITICAL –ø—Ä–æ–±–ª–µ–º—ã** (P0)
2. **–î–æ–±–∞–≤–∏—Ç—å rollback —Ñ—É–Ω–∫—Ü–∏–∏**
3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å path traversal protection**
4. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
5. **–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ test environment**

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ HIGH –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å comprehensive testing
3. –£–ª—É—á—à–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
4. –î–æ–±–∞–≤–∏—Ç—å monitoring –∏ alerting

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1 –º–µ—Å—è—Ü)

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ MEDIUM –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
2. –î–æ–±–∞–≤–∏—Ç—å automated testing
3. –°–æ–∑–¥–∞—Ç—å CI/CD pipeline
4. –î–æ–±–∞–≤–∏—Ç—å performance monitoring

---

## 10. Conclusion

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç **–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –∏ **—Ö–æ—Ä–æ—à—É—é –æ—Å–Ω–æ–≤—É**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π** –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ production. –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö CRITICAL –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ enterprise —Å—Ä–µ–¥–µ.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ CRITICAL –ø—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–µ–¥ deployment**

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**: –ù–∞—á–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º.
