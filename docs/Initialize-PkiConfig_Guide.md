# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: Initialize-PkiConfig.ps1

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `Initialize-PkiConfig.ps1` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª `env.json` –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ì—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**
- **Administrators** (–ª–æ–∫–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞) ‚Äî –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–µ—Å—Ç—Ä—É, —Å–ª—É–∂–±–∞–º, IIS

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- **Domain Admins** (–¥–æ–º–µ–Ω–Ω–∞—è –≥—Ä—É–ø–ø–∞) ‚Äî –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ–º–µ–Ω–µ —á–µ—Ä–µ–∑ Active Directory

### –ì–¥–µ –∑–∞–ø—É—Å–∫–∞—Ç—å

**–ù–∞ CA1 (Issuing CA) —Å–µ—Ä–≤–µ—Ä–µ** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```powershell
.\src\Initialize-PkiConfig.ps1
```

### –° –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞

```powershell
.\src\Initialize-PkiConfig.ps1 -Force
```

### –° —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–µ–π

```powershell
.\src\Initialize-PkiConfig.ps1 `
    -ConfigPath "config\env.json" `
    -ExampleConfigPath "config\env.example.json"
```

## –ß—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### ‚úÖ –î–æ–º–µ–Ω

**–ú–µ—Ç–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞):**
1. Active Directory –º–æ–¥—É–ª—å (`Get-ADDomain`)
2. System.DirectoryServices (`[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()`)
3. WMI (`Win32_ComputerSystem`)
4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`$env:USERDNSDOMAIN`)

**–û–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `domain.name`
- `domain.fqdn`
- `domain.netbios`

### ‚úÖ CA1 (Issuing CA)

**–ú–µ—Ç–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:**
1. –†–µ–µ—Å—Ç—Ä: `HKLM:\SYSTEM\CurrentControlSet\Services\CertSvc\Configuration\*`
2. certutil: `certutil -cainfo`
3. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `$env:COMPUTERNAME`, DNS

**–û–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ca1.name` ‚Äî –∏–º—è CA –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞ –∏–ª–∏ certutil
- `ca1.hostname` ‚Äî –∏–º—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
- `ca1.dnsName` ‚Äî FQDN —Å–µ—Ä–≤–µ—Ä–∞
- `ca1.commonName` ‚Äî Common Name –∏–∑ certutil
- `ca1.type` ‚Äî —Ç–∏–ø CA (EnterpriseSubordinateCA)
- `ca1.status` ‚Äî online/offline (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–ª—É–∂–±—ã)
- `ca1.serviceName` ‚Äî –æ–±—ã—á–Ω–æ "CertSvc"

### ‚úÖ IIS

**–ú–µ—Ç–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏: `Get-WindowsFeature Web-Server`
2. WebAdministration –º–æ–¥—É–ª—å: `Get-WebSite`, `Get-WebBinding`

**–û–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `iis.siteName` ‚Äî –ø–µ—Ä–≤—ã–π —Å–∞–π—Ç (–æ–±—ã—á–Ω–æ "Default Web Site")
- `iis.webRootPath` ‚Äî —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å —Å–∞–π—Ç–∞
- `iis.pkiWebRoot` ‚Äî –ø—É—Ç—å PKI (webRootPath\PKI)
- `iis.certEnrollPath` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å (C:\Windows\System32\CertSrv\CertEnroll)
- `iis.bindings` ‚Äî –ø—Ä–∏–≤—è–∑–∫–∏ —Å–∞–π—Ç–∞ (protocol, port, hostname)

### ‚úÖ –ü—É—Ç–∏

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ IIS web root:**
- `paths.certEnrollPath` ‚Äî C:\Windows\System32\CertSrv\CertEnroll
- `paths.pkiWebRoot` ‚Äî {webRoot}\PKI
- `paths.pkiAiaPath` ‚Äî {webRoot}\PKI\AIA
- `paths.pkiCdpPath` ‚Äî {webRoot}\PKI\CDP
- `paths.legacyCertsPath` ‚Äî {webRoot}\Certs
- `paths.legacyCertsAiaPath` ‚Äî {webRoot}\CertsAIA

### ‚úÖ Endpoints

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ CA1 hostname:**
- `endpoints.healthCheck` ‚Äî URLs –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- `endpoints.crlUrls` ‚Äî —à–∞–±–ª–æ–Ω—ã URLs –¥–ª—è CRL
- `endpoints.aiaUrls` ‚Äî —à–∞–±–ª–æ–Ω—ã URLs –¥–ª—è AIA

## –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é

### ‚ùå CA0 (Root CA)

**–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CA0 —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è:**
- `ca0.name` ‚Äî –∏–º—è Root CA
- `ca0.hostname` ‚Äî hostname —Å–µ—Ä–≤–µ—Ä–∞ CA0
- `ca0.dnsName` ‚Äî FQDN —Å–µ—Ä–≤–µ—Ä–∞ CA0
- `ca0.commonName` ‚Äî Common Name Root CA
- `ca0.type` ‚Äî –æ–±—ã—á–Ω–æ "StandaloneRootCA"
- `ca0.status` ‚Äî –æ–±—ã—á–Ω–æ "offline"
- `ca0.crlPolicy` ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∞ CRL –¥–ª—è Root CA

**–ü—Ä–∏—á–∏–Ω–∞:** CA0 –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (offline), –ø–æ—ç—Ç–æ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `Get-CA0Config.ps1` –Ω–∞ CA0 —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

### –°–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ CA0

**–ù–∞ CA0 —Å–µ—Ä–≤–µ—Ä–µ:**

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ CA0
.\src\Get-CA0Config.ps1
```

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–∞–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (Administrators) ‚Äî **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**
- –ó–∞–ø—É—Å–∫ –Ω–∞ CA0 (Root CA) —Å–µ—Ä–≤–µ—Ä–µ

**–ü—Ä–æ—Ü–µ–¥—É—Ä–∞:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `Get-CA0Config.ps1` –Ω–∞ CA0 —Å–µ—Ä–≤–µ—Ä–µ
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
3. –ù–∞ CA1 —Å–µ—Ä–≤–µ—Ä–µ –≤—Å—Ç–∞–≤—å—Ç–µ –∏—Ö –≤ —Å–µ–∫—Ü–∏—é `ca0` —Ñ–∞–π–ª–∞ `config\env.json`
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `docs/Get-CA0Config_Guide.md`

### ‚ö†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
- `crlPolicyTargets` ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∏ CRL (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `templates` ‚Äî —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `monitoring` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  PKI Configuration Initialization Script                    ‚ïë
‚ïë  –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ env.json            ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ ===
‚úÖ –ü—Ä–∞–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: OK
‚úÖ –ü—Ä–∞–≤–∞ Domain Admin: OK

=== –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ ===
‚úÖ –î–æ–º–µ–Ω –æ–ø—Ä–µ–¥–µ–ª—ë–Ω —á–µ—Ä–µ–∑ AD: contoso.local

=== –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CA1 (Issuing CA) ===
‚úÖ CA1 –æ–ø—Ä–µ–¥–µ–ª—ë–Ω:
   Name: CONTOSO-Issuing-CA
   Hostname: CA1-ISSUING
   DNS: ca1-issuing.contoso.local
   Common Name: CONTOSO Issuing CA

=== –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IIS ===
‚úÖ IIS –æ–ø—Ä–µ–¥–µ–ª—ë–Ω:
   Site: Default Web Site
   Web Root: C:\inetpub\wwwroot
   CertEnroll: C:\Windows\System32\CertSrv\CertEnroll

=== –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π ===
‚úÖ –ü—É—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:
   PKI Web Root: C:\inetpub\wwwroot\PKI
   PKI AIA: C:\inetpub\wwwroot\PKI\AIA
   PKI CDP: C:\inetpub\wwwroot\PKI\CDP

=== –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ endpoints ===
‚úÖ Endpoints —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ ca1-issuing.contoso.local

=== –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ===
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞: config\env.json

=== –†–ï–ó–£–õ–¨–¢–ê–¢–´ ===
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: config\env.json

üìù –í–ê–ñ–ù–û: –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CA0 (Root CA) –≤—Ä—É—á–Ω—É—é:
   - ca0.name
   - ca0.hostname
   - ca0.dnsName
   - ca0.commonName

CA0 –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (offline)

‚úÖ –ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª

```powershell
notepad config\env.json
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.

### 3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ CA0 –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é `ca0` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:
- `name` ‚Äî –∏–º—è Root CA
- `hostname` ‚Äî hostname —Å–µ—Ä–≤–µ—Ä–∞ CA0
- `dnsName` ‚Äî FQDN —Å–µ—Ä–≤–µ—Ä–∞ CA0
- `commonName` ‚Äî Common Name –∏–∑ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ Root CA

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ JSON

```powershell
$config = Get-Content config\env.json -Raw -Encoding UTF8 | ConvertFrom-Json
Write-Host "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ" -ForegroundColor Green
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "–¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"

**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤ –≥—Ä—É–ø–ø–µ Administrators

### –ü—Ä–æ–±–ª–µ–º–∞: "CA –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —ç—Ç–æ–º —Å–µ—Ä–≤–µ—Ä–µ"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ CA1 (Issuing CA) —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É AD CS: `Get-WindowsFeature | Where-Object { $_.Name -like "*ADCS*" }`

### –ü—Ä–æ–±–ª–µ–º–∞: "IIS –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ IIS: `Install-WindowsFeature -Name Web-Server, Web-Mgmt-Console`
- –ò–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã IIS –≤—Ä—É—á–Ω—É—é

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–æ–º–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –≤ –¥–æ–º–µ–Ω–µ
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ RSAT: `Install-WindowsFeature -Name RSAT-AD-PowerShell`
- –ò–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–º–µ–Ω–∞ –≤—Ä—É—á–Ω—É—é

### –ü—Ä–æ–±–ª–µ–º–∞: "–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `-Force` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏: `.\src\Initialize-PkiConfig.ps1 -Force`
- –ò–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
2. ‚úÖ –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CA0 –≤—Ä—É—á–Ω—É—é
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∞—É–¥–∏—Ç: `.\src\pki-audit\Invoke-PkiAudit.ps1`

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `QUICKSTART.md` ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [`docs/WHERE_TO_RUN_SCRIPTS.md`](WHERE_TO_RUN_SCRIPTS.md) ‚Äî –Ω–∞ –∫–∞–∫–æ–º CA –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã
- `README.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
